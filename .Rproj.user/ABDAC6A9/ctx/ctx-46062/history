bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=500,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=50,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=500,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5000,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=500,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=500,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=500,main.n=5)
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
iter=1
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
pilot.num=150
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
cat(paste("  Progress:",round(100*iter/pilot.num),"%"))
cat(paste("  Progress:",round(100*iter/pilot.num),"%"))
cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
pilot.num=100000
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
pilot.num=1e7
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
cat("Pilot chain:",'\n')
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
qwe=function(){
cat("Pilot chain:",'\r')
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
qwe()
qwe=function(){
cat("Pilot chain:",'\n')
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
qwe()
qwe()
qwe()
qwe=function(){
#	cat("Pilot chain:",'\n')
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
qwe()
qwe()
qwe=function(){
cat("Pilot chain:",'\n')
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
qwe()
qwe()
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
qwe=function(){
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
qwe=function(){
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%","                        "),"\r")
}
}
qwe()
qwe=function(){
for(iter in 1:pilot.num){
if(iter%%round(max(1,pilot.num/100))==0) cat(paste("  Progress:",round(100*iter/pilot.num),"%"),"\r")
}
}
qwe()
cat("1 \r"); cat("2 \r"); cat("3 \r"); cat("4 \r")
cat("1 \r"); cat("2 \r"); cat("3 \r"); cat("4 \r")
cat("1 \n"); cat("2 \r"); cat("3 \r"); cat("4 \r")
cat("1 \r"); cat("2 \r"); cat("3 \r"); cat("4 \r");cat("\n")
library(bmsaplm)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilon.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,pilot.burnin=5,main.n=5)
rep("+",50)
paste(rep("+",50))
paste(rep("+",50),collapse="")
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,pilot.burnin=5,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=15,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=25,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=45,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=145,pilot.burnin=5,main.n=5)
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20),pilot.n=5,pilot.burnin=5,main.n=5)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
library(bmsaplm)
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
estaplm
?estaplm
estaplm(y,X,Z)
data(betaplasma)
dataset=data.frame(data.matrix(betaplasma))
dataset=data.frame(log(dataset$betacaro),dataset)
dataset=dataset[dataset$log.dataset.betacaro.!=-Inf,]
y=dataset$log.dataset.betacaro.
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
estaplm(y,X,Z)
?data
library(bmsaplm)
?data
data()
try(data(package = "bmsaplm") )
data(simulation)
simulation
simulation[,1]
?bmsaplm
library(bmsaplm)
data(betacaro)
?data
data(betacaro)
load("C:/Dropbox/Rpackages/bmsaplm/data/betacaro.RData")
betacaro
try(data(package = "bmsaplm") )
betacaro
library(bmsaplm)
data(betacaro)
library(bmsaplm)
data(betacaro)
betacaro
library(bmsaplm)
data(betacaro)
betacaro
betacaro$logbetacaro
betacaro$logbetacaro!=-Inf
betacaro[,betacaro$logbetacaro!=-Inf]
betacaro[betacaro$logbetacaro!=-Inf,]
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
is.data.frame(dataset)
library(bmsaplm)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)
library(bmsaplm)
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
library(bmsaplm)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))   # this works.
bms2=bmsaplm(y,X,nKnot=c(20,20,20,20,20,8,20,20,20))     # only with nonlinear components.
summary(bms1)
bms1
summary(bms2)
library(bmsaplm)
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
X
name(X)
names(X)
names(X)="age"
X
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
summary(est1)
plot(est1)
library(bmsaplm)
library(bmsaplm)
library(bmsaplm)
library(bmsaplm)
?bmsaplm
library(bmsaplm)
?bmsaplm
library(bmsaplm)
?bmsaplm
library(bmsaplm)
?estaplm
library(bmsaplm)
?bmsaplm
library(bmsaplm)
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
est2=estaplm(y,X)     # only with the nonlinear component, Age.
summary(est1)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age")]
Z=dataset[,c("sex","smokestat","vituse")]
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
bms1=bmsaplm(y,X,Z
bms1=bmsaplm(y,X,Z)
bms1=bmsaplm(y,X)
X2=dataset[,c("age","bmi")]
bmsaplm(y,X2)
X1=dataset[,c("age")]
bmsaplm(y,X1)
library(bmsaplm)
bmsaplm(y,X1)
qwe=bmsaplm(y,X1)
summary(qwe)
library(bmsaplm)
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
summary(bms1)
X=dataset[,c("age")]
bms1=bmsaplm(y,X,Z)
bms1=bmsaplm(y,X,Z)
summary(bms1)
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))   # this works.
library(bmsaplm)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))   # this works.
bms1
summary(bms1)
print
print
print
library(bmsaplm)
library(bmsaplm)
?aplm
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
plot(est1)
library(bmsaplm)
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
plot(est1)
library(bmsaplm)
library(bmsaplm)
library(bmsaplm)
library(bmsaplm)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))
bms1
summary(bms1)
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
summary(est1)
plot(est1)
predict(est1)
x=unlist(dataset[150,2:7])
z=unlist(dataset[150,8:13])
dataset$Y[150]
pred=predict.estaplm(est,x,z)
x=unlist(dataset[150,2:7])
z=unlist(dataset[150,8:13])
dataset$Y[150]
pred=predict.estaplm(est1,x,z)
x
z
x=X[1,]
X
x=X[1]
z=Z[1,]
pred=predict.estaplm(est1,x,z)
z
z=as.vector(z)
pred(est1,x,z)
predict(est1,x,z)
x
x=as.vector(x)
predict(est1,x,z)
z
z=as.vector(z)
predict(est1,x,z)
is.vector(x)
is.vector(z)
as.vector(z)
unlist(z)
z=unlist(z)
predict(est1,x,z)
qqq=predict(est1,x,z)
plot(qqq)
summary(qqq)
library(bmsaplm)
Z=matrix(rnorm(9),3,3)
mZ=colMeans(Z)
Z-mZ
CentMat(Z,mZ)
t(t(Z)-mZ)
Z=matrix(rnorm(100000),100,1000)
mZ=colMeans(Z)
library(micobenchmark)
library(microbenchmark)
library(microbenchmark)
microbenchmark(t(t(Z)-mZ))
microbenchmark(t(t(Z)-mZ))
microbenchmark(CentMat(Z,mZ))
Z=matrix(rnorm(1000000),1000,1000)
mZ=colMeans(Z)
microbenchmark(t(t(Z)-mZ))
microbenchmark(CentMat(Z,mZ))
Q=sweep(Z,2,mZ)
identical(Q,t(t(Z)-mZ))
microbenchmark(sweep(Z,2,mZ))
microbenchmark(t(t(Z)-mZ))
microbenchmark(sweep(Z,2,mZ))
sum((Q-t(t(Z)-mZ))^2)
library(bmsaplm)
?bmsaplm
ata(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))   # this works.
summary(bms1)
Z=matrix(rnorm(5000000),5000,1000)
CentMat(Z,colMeans(Z))[1,]
sweep(Z,2,colMeans(Z))[1,]
microbenchmark(sweep(Z,2,colMeans(Z)))
microbenchmark(CentMat(Z,colMeans(Z))
)
library(bmsaplm)
library(bmsaplm)
?bmsaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,c("age","bmi","calories","fat","fiber","alcohol","chol","betadiet","retdiet")]
Z=dataset[,c("sex","smokestat","vituse")]
bmsaplm(y,X,Z)   # this does not work.
bms1=bmsaplm(y,X,Z,nKnot=c(20,20,20,20,20,8,20,20,20))   # this works.
summary(bms1)
?estaplm
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
library(bmsaplm)
data(betacaro)
dataset=betacaro[betacaro$logbetacaro!=-Inf,]
y=dataset$logbetacaro
X=dataset[,"age"]
Z=dataset[,c("fiber","bmi","sex","smokestat","vituse")]
# X and Z are chosen by model selection; see the function bmsaplm.
est1=estaplm(y,X,Z)
summary(est1)
plot(est1)
?microbenchmark
?lm
library(bmsaplm)
library(bmsaplm)
estaplm
?estaplm
library(bmsaplm)
?estaplm
library(bmsaplm)
?estaplm
library(bmsaplm)
?estaplm
library(bmsaplm)
?estaplm
